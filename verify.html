<!DOCTYPE html>
<html>
<head>
  <title>Verify Document | TrustDoc</title>

  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2/dist/umd/supabase.js"></script>

  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f7f9fb;
      padding: 40px;
      text-align: center;
      color: #0A2540;
    }

    .box {
      max-width: 420px;
      margin: auto;
      background: white;
      padding: 30px;
      border-radius: 8px;
      box-shadow: 0 0 10px rgba(0,0,0,0.05);
    }

    input, button {
      padding: 10px;
      margin: 6px;
      width: 260px;
    }

    button {
      background: #0A2540;
      color: white;
      border: none;
      cursor: pointer;
    }

    button:hover {
      background: #163a6b;
    }

    .success {
      color: green;
      margin-top: 15px;
    }

    .error {
      color: red;
      margin-top: 15px;
    }
  </style>
</head>
<body>

<div class="box">
  <h1>Verify Document</h1>
  <p>Enter a TrustDoc verification code to confirm authenticity.</p>

  <input id="codeInput" placeholder="e.g. TD-A9F3KQ"><br>
  <button onclick="verifyDoc()">Verify</button>

  <div id="result"></div>
</div>

<script>
  const supabaseClient = window.supabase.createClient(
    "https://cdhixtigmdszjkpbmzhs.supabase.co",
    "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImNkaGl4dGlnbWRzemprcGJtemhzIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjY3NzcwMDgsImV4cCI6MjA4MjM1MzAwOH0.PAuVbbvHIMmHX9RC-_sQcoCaXg07rHYd_SbeDjVHNto"
  );

  async function verifyDoc() {
    const code = document.getElementById("codeInput").value.trim();
    const result = document.getElementById("result");

    if (!code) {
      result.innerHTML = "<p class='error'>Please enter a verification code.</p>";
      return;
    }

    result.innerHTML = "Checking…";

    const { data, error } = await supabaseClient
      .from("documents")
      .select("file_name, created_at")
      .eq("verification_code", code)
      .single();

    if (error || !data) {
      result.innerHTML =
        "<p class='error'>❌ Document not found or invalid code.</p>";
      return;
    }

    result.innerHTML = `
      <p class="success">✅ Document verified</p>
      <p><b>File name:</b> ${data.file_name}</p>
      <p><b>Uploaded on:</b> ${new Date(data.created_at).toDateString()}</p>
    `;
  }
</script>

</body>
    </html>
